"use strict";angular.module("chayka-auth").directive("authLinkedinButton",["$translate","ajax","auth",function($translate,ajax,auth){var $=angular.element,lnkdn={$scope:null,notAuthorized:!1,IN:window.IN,currentUser:window.Chayka.Users.currentUser,getIN:function(){return!lnkdn.IN&&window.IN&&(lnkdn.IN=window.IN,lnkdn.IN.Event.on(window.IN,"auth",lnkdn.onStatusChanged)),lnkdn.IN},getInUserId:function(){return lnkdn.currentUser.meta.in_user_id},onStatusChanged:function(){lnkdn.onInLogin(lnkdn.IN.ENV.auth)},onLoginButtonClicked:function(event){event&&event.preventDefault(),lnkdn.getIN()&&lnkdn.IN.User.authorize(lnkdn.onStatusChanged,lnkdn)},onInLogin:function(INResponse){console.dir({INResponse:INResponse}),ajax.post("/api/linkedin/login",INResponse,{spinner:!1,showMessage:!1,errorMessage:$translate.instant("message_error_auth_failed"),success:function(data){lnkdn.$scope.$emit("Chayka.Users.currentUserChanged",data.payload)},complete:function(){}})}};return auth.LinkedIn=lnkdn,{restrict:"A",link:function($scope,element){lnkdn.getIN(),lnkdn.$scope=$scope,$(document).on("logout",lnkdn.logout),$(element).click(lnkdn.onLoginButtonClicked)}}}]);